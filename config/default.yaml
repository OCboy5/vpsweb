# Vox Poetica Studio Web - Main Configuration
# Enhanced with workflow mode support for reasoning and non-reasoning models

# Workflow mode selection: 'reasoning', 'non_reasoning', or 'hybrid'
workflow_mode: "hybrid"  # Default to balanced approach

workflow:
  name: "vox_poetica_translation"
  version: "2.0.0"

  # Pure Reasoning Workflow Configuration
  reasoning_workflow:
    initial_translation:
      provider: "deepseek"
      model: "deepseek-reasoner"
      temperature: 0.2
      max_tokens: 16384
      prompt_template: "initial_translation_reasoning"
      timeout: 300.0
      retry_attempts: 2
      stop: ["</initial_translation_notes>"]

    # editor_review:
    #   provider: "deepseek"
    #   model: "deepseek-reasoner"
    #   temperature: 0.1
    #   max_tokens: 16384
    #   prompt_template: "editor_review_reasoning"
    #   timeout: 300.0
    #   retry_attempts: 2
    #   stop: ["</editor_suggestions>"]

    editor_review:
      provider: "siliconflow"
      model: "deepseek-ai/DeepSeek-V3.2-Exp"
      temperature: 0.1
      max_tokens: 16384
      prompt_template: "editor_review_reasoning"
      timeout: 300.0
      retry_attempts: 2
      stop: ["</editor_suggestions>"]  

    translator_revision:
      provider: "deepseek"
      model: "deepseek-reasoner"
      temperature: 0.15
      max_tokens: 16384
      prompt_template: "translator_revision_reasoning"
      timeout: 300.0
      retry_attempts: 2
      stop: ["</revised_translation_notes>"]

  # Pure Non-Reasoning Workflow Configuration
  non_reasoning_workflow:
    initial_translation:
      provider: "tongyi"
      model: "qwen-plus-latest"
      temperature: 0.7
      max_tokens: 8192
      prompt_template: "initial_translation_nonreasoning"
      timeout: 180.0
      retry_attempts: 3
      stop: ["</initial_translation_notes>"]

    editor_review:
      provider: "tongyi"
      model: "qwen-plus-latest"
      temperature: 0.3
      max_tokens: 8192
      prompt_template: "editor_review_nonreasoning"
      timeout: 180.0
      retry_attempts: 3
      stop: ["</editor_suggestions>"]

    translator_revision:
      provider: "tongyi"
      model: "qwen-plus-latest"
      temperature: 0.2
      max_tokens: 8192
      prompt_template: "translator_revision_nonreasoning"
      timeout: 180.0
      retry_attempts: 3
      stop: ["</revised_translation_notes>"]

  # Hybrid Workflow Configuration (Non-Reasoning → Reasoning → Non-Reasoning)
  hybrid_workflow:
    initial_translation:
      provider: "tongyi"
      model: "qwen-plus-latest"
      temperature: 0.7
      max_tokens: 8192
      prompt_template: "initial_translation_nonreasoning"
      timeout: 180.0
      retry_attempts: 3
      stop: ["</initial_translation_notes>"]

    # editor_review:
    #   provider: "deepseek"
    #   model: "deepseek-reasoner"
    #   temperature: 0.1
    #   max_tokens: 16384
    #   prompt_template: "editor_review_reasoning"
    #   timeout: 300.0
    #   retry_attempts: 2
    #   stop: ["</editor_suggestions>"]

    editor_review:
      provider: "siliconflow"
      model: "deepseek-ai/DeepSeek-V3.2-Exp"
      temperature: 0.1
      max_tokens: 16384
      prompt_template: "editor_review_reasoning"
      timeout: 300.0
      retry_attempts: 2
      stop: ["</editor_suggestions>"] 

    translator_revision:
      provider: "tongyi"
      model: "qwen-plus-latest"
      temperature: 0.2
      max_tokens: 8192
      prompt_template: "translator_revision_nonreasoning"
      timeout: 180.0
      retry_attempts: 3
      stop: ["</revised_translation_notes>"]

  
storage:
  output_dir: "outputs"
  format: "json"
  include_timestamp: true
  pretty_print: true
  workflow_mode_tag: true  # Include workflow mode in output filename

  # Default output directories
  wechat_articles_dir: "outputs/wechat_articles"
  cache_dir: "outputs/.cache"

logging:
  level: "INFO"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  file: "vpsweb.log"
  max_file_size: 10485760  # 10MB
  backup_count: 5
  log_reasoning_tokens: true  # Track reasoning model token usage

# Performance monitoring
monitoring:
  track_latency: true
  track_token_usage: true
  track_cost: true  # Estimate API costs
  compare_workflows: true  # Enable A/B comparison

# System-wide settings
system:
  # Token management
  token_refresh_buffer: 300  # seconds (5 minutes) - refresh token before expiry
  default_token_expiry: 7200  # seconds (2 hours) - default WeChat token expiry

  # Preview lengths for logs and UI
  preview_lengths:
    input_preview: 100  # characters
    response_preview: 200  # characters
    editor_preview: 200  # characters

  # Default messages
  default_digest: "诗歌翻译作品，展现中英文学之美，传递文化精髓。"

  # Translation notes synthesis parameters
  translation_notes:
    reasoning:
      temperature: 0.1
      max_tokens: 2000
      timeout: 60  # seconds
    non_reasoning:
      temperature: 0.3
      max_tokens: 1500
      timeout: 45  # seconds